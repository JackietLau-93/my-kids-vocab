<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TinyVocab (Static)</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Varela+Round&display=swap" rel="stylesheet">
<style>
    :root {
        --c-animal: #8AC926; --c-food: #FFCA3A; --c-body: #1982C4; 
        --c-home: #FF595E; --c-act: #6A4C93;
        --bg: #F0F4F8; --text: #333;
    }
    body { font-family: 'Varela Round', sans-serif; background: var(--bg); margin: 0; color: var(--text); }
    h1, h2, h3, button { font-family: 'Fredoka One', cursive; }
    .hidden { display: none !important; }
    
    /* HEADER */
    header { background: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
    .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; }
    .btn-primary { background: #333; color: white; }

    /* GRID LAYOUT */
    .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
    
    /* CARD DESIGN */
    .vocab-card {
        background: white; border-radius: 12px; overflow: hidden;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05); transition: transform 0.2s;
        border-bottom: 5px solid #ccc; /* Default color */
    }
    .vocab-card:hover { transform: translateY(-5px); }
    .vocab-card img { width: 100%; height: 180px; object-fit: cover; }
    .vocab-card .word { font-size: 1.5rem; text-align: center; padding: 10px; color: #444; text-transform: lowercase; }

    /* CHILD MODE */
    #child-mode { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: white; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    .big-card { width: 90vw; max-width: 400px; aspect-ratio: 3/4; border: 8px solid #333; border-radius: 20px; overflow: hidden; display: flex; flex-direction: column; }
    .big-card img { flex: 1; object-fit: contain; padding: 20px; }
    .big-card .word-box { height: 100px; display: flex; align-items: center; justify-content: center; background: #f9f9f9; font-size: 3rem; }
    .controls { margin-top: 20px; display: flex; gap: 20px; }
    .nav-btn { width: 70px; height: 70px; border-radius: 50%; font-size: 2rem; border: none; background: #eee; cursor: pointer; }

    /* PRINT STYLES */
    @media print {
        header, .container, #child-mode { display: none !important; }
        body { background: white; }
        #print-area { display: block !important; }
        .p-page { break-after: page; width: 100vw; height: 100vh; display: flex; align-items: center; justify-content: center; }
        .p-card-a4 { display: flex; width: 90%; height: 90%; border: 10px solid; }
        .p-card-a4 img { flex: 2; object-fit: contain; }
        .p-card-a4 div { flex: 1; font-size: 80pt; display: flex; align-items: center; justify-content: center; border-left: 10px solid; }
        
        .p-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 10px; }
        .p-card-small { border: 1px dashed #ccc; height: 88mm; display: flex; flex-direction: column; align-items: center; }
        .p-card-small img { height: 70%; width: 90%; object-fit: contain; margin-top: 10px; }
        .p-card-small div { font-size: 20pt; margin-top: 5px; }
    }
</style>
</head>
<body>

<header>
    <h2>ü¶Å TinyVocab</h2>
    <div style="display:flex; gap:10px">
        <button class="btn" onclick="printA4()">üñ®Ô∏è A4</button>
        <button class="btn" onclick="printPoker()">üñ®Ô∏è Cards</button>
        <button class="btn btn-primary" onclick="startChild()">üë∂ Child Mode</button>
    </div>
</header>

<div class="container">
    <div id="loading">Loading your deck...</div>
    <div class="card-grid" id="grid"></div>
</div>

<div id="child-mode" class="hidden">
    <button onclick="exitChild()" style="position:absolute; top:20px; right:20px; padding:10px;">‚úï</button>
    <div class="big-card" id="big-card">
        <img id="c-img" src="">
        <div class="word-box" id="c-word">Word</div>
    </div>
    <div class="controls">
        <button class="nav-btn" onclick="move(-1)">üëà</button>
        <button class="nav-btn" onclick="speak()" style="background:#FFCA3A">üîä</button>
        <button class="nav-btn" onclick="move(1)">üëâ</button>
    </div>
</div>

<div id="print-area" style="display:none"></div>

<script>
    let deck = [];
    let childIndex = 0;
    const colors = { animal: '#8AC926', food: '#FFCA3A', body: '#1982C4', home: '#FF595E', act: '#6A4C93' };

    // 1. FETCH DATA
    fetch('data.json')
        .then(response => response.json())
        .then(data => {
            deck = data;
            document.getElementById('loading').style.display = 'none';
            renderGrid();
        })
        .catch(err => {
            document.getElementById('loading').innerHTML = 
            '‚ö†Ô∏è Could not load data.json.<br>If you are opening this file locally, use a Local Server or upload to GitHub.';
        });

    // 2. RENDER DASHBOARD
    function renderGrid() {
        const grid = document.getElementById('grid');
        grid.innerHTML = deck.map(card => `
            <div class="vocab-card" style="border-color:${colors[card.cat] || '#ccc'}">
                <img src="${card.img}" loading="lazy">
                <div class="word" style="color:${colors[card.cat]}">${card.word}</div>
            </div>
        `).join('');
    }

    // 3. CHILD MODE
    function startChild() {
        document.getElementById('child-mode').classList.remove('hidden');
        updateChild();
    }
    function exitChild() { document.getElementById('child-mode').classList.add('hidden'); }
    
    function updateChild() {
        const card = deck[childIndex];
        const col = colors[card.cat] || '#333';
        document.getElementById('c-img').src = card.img;
        document.getElementById('c-word').innerText = card.word;
        document.getElementById('c-word').style.color = col;
        document.getElementById('big-card').style.borderColor = col;
    }
    
    function move(dir) {
        childIndex = (childIndex + dir + deck.length) % deck.length;
        updateChild();
        speak();
    }
    
    function speak() {
        const u = new SpeechSynthesisUtterance(deck[childIndex].word);
        u.rate = 0.9;
        window.speechSynthesis.speak(u);
    }
    
    document.addEventListener('keydown', e => {
        if(document.getElementById('child-mode').classList.contains('hidden')) return;
        if(e.key === 'ArrowRight') move(1);
        if(e.key === 'ArrowLeft') move(-1);
        if(e.key === ' ') speak();
        if(e.key === 'Escape') exitChild();
    });

    // 4. PRINTING
    function printA4() {
        const area = document.getElementById('print-area');
        area.innerHTML = deck.map(c => {
            const col = colors[c.cat] || '#333';
            return `<div class="p-page"><div class="p-card-a4" style="border-color:${col}"><img src="${c.img}"><div style="color:${col}; border-left-color:${col}">${c.word}</div></div></div>`;
        }).join('');
        window.print();
    }

    function printPoker() {
        const area = document.getElementById('print-area');
        area.innerHTML = '<div class="p-grid">' + deck.map(c => {
            const col = colors[c.cat] || '#333';
            return `<div class="p-card-small" style="border-color:${col}"><img src="${c.img}"><div style="color:${col}">${c.word}</div></div>`;
        }).join('') + '</div>';
        window.print();
    }
</script>

</body>
</html>